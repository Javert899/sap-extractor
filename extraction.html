<html>
    <head>
        <script src="static/jquery.min.js" type="text/javascript"></script>
        <script src="static/bootstrap.min.js" type="text/javascript"></script>
        <script src="static/FileSaver.min.js" type="text/javascript"></script>
        <link rel="stylesheet" href="static/style.css">

    </head>
    <body style="background-color: lightblue">
        <div class="center">
			<div>
				Connection to the database:
				<select id="connection_types" name="connection_types" onchange="changeConnectionType()">
					<option value="sqlite" selected="selected">SQLite Connection</option>
					<option value="oracle">Oracle Connection</option>
				</select>
				<br />
				<div id="sqlite_conn_parameters" style="display:">
					<p><b>Parameters of connection to the SQLite database:</b></p>
					SQLite Database Path:&nbsp;&nbsp;<input type="text" id="sqlite_db_path" value="sap.sqlite"></input><br />
				</div>
				<div id="oracle_conn_parameters" style="display:none">
					<p><b>Parameters of connection to the Oracle database:</b></p>
					Oracle Hostname:&nbsp;&nbsp;<input type="text" id="oracle_hostname" value="127.0.0.1"></input><br />
					Oracle Port:&nbsp;&nbsp;<input type="text" id="oracle_port" value="1521"></input><br />
					Oracle SID:&nbsp;&nbsp;<input type="text" id="oracle_sid" value="XE"></input><br />
					Oracle Username:&nbsp;&nbsp;<input type="text" id="oracle_username" value="system"></input><br />
					Oracle Password:&nbsp;&nbsp;<input type="text" id="oracle_password" value="oracle"></input><br />
				</div>
			</div>
			<br />
			<div>
				Process to extract:
				<select id="available_processes" name="available_processes" onchange="changeProcess()">
					<option value="o2c" selected="selected">Order-to-Cash</option>
					<option value="ap_ar">Accounts Payable/Receivable</option>
					<option value="p2p">Procure-to-Pay</option>
				</select>
				<br />
				<div id="o2c" style="display:">
					<p><b>Order-to-Cash</b></p>
					<table border="0" style="width: 100%">
						<tr>
							<td style="width: 40%">
								<img src="static/o2c_red.png">
								</img>
							</td>
							<td style="width: 60%">
								Extraction Type:
								<select id="o2c_ext_type" name="o2c_ext_type" onchange="o2cExtChange()">
									<option value="o2c_1d_log_extractor" selected="selected">XES</option>
									<option value="o2c_1d_dataframe_extractor">CSV</option>
									<option value="o2c_obj_centric_log">Object-Centric Log</option>
								</select>
								<br />
								<div id="o2c_log" style="display:">
									<p>Insert the parameters for the log extraction:</p>
									Reference document type: <input type="text" id="o2c_log_reference_type" value="Order"></input>
								</div>
								<div id="o2c_dataframe" style="display: none">
									<p>Insert the parameters for the CSV extraction:</p>
									Reference document type: <input type="text" id="o2c_df_reference_type" value="Order"></input>
								</div>
								<div id="o2c_obj" style="display: none">
									<p>Insert the parameters for the object-centric log extraction:
								</div>
							</td>
						</tr>
					</table>
				</div>
				<div id="ap_ar" style="display: none">
					<p><b>Accounts Payable / Accounts Receivable</b></p>
					<table border="0" style="width: 100%">
						<tr>
							<td style="width: 40%">
								<img src="static/bkpf_red.png" style="width: 90%">
								</img>
							</td>
							<td style="width: 60%">
								Extraction Type:
								<select id="apar_ext_type" name="apar_ext_type" onchange="apArExtChange()">
									<option value="single_doc_transactions_dataframe">Single transactions (CSV)</option>
									<option value="single_doc_transactions_log">Single transactions (XES)</option>
									<option value="document_flow_dataframe">Document flow (CSV)</option>
									<option value="document_flow_log" selected="selected">Document flow (XES)</option>
									<option value="doc_flow_transactions_dataframe">Document flow transactions (CSV)</option>
									<option value="doc_flow_transactions_xes">Document flow transactions (XES)</option>
									<option value="apar_obj_centr_log">Object-Centric Log</option>
								</select>
								<br />
								<div id="single_doc_transactions_dataframe" style="display: none">
									<p>Insert the parameters for the CSV extraction (single transactions):</p>
								</div>
								<div id="single_doc_transactions_log" style="display: none">
									<p>Insert the parameters for the XES extraction (single transactions):</p>
								</div>
								<div id="document_flow_dataframe" style="display: none">
									<p>Insert the parameters for the CSV extraction (document flow):</p>
								</div>
								<div id="document_flow_log" style="display: ">
									<p>Insert the parameters for the XES extraction (document flow):</p>
								</div>
								<div id="doc_flow_transactions_dataframe" style="display: none">
									<p>Insert the parameters for the CSV extraction (document flow transactions):</p>
								</div>
								<div id="doc_flow_transactions_xes" style="display: none">
									<p>Insert the parameters for the XES extraction (document flow transactions):</p>
								</div>
								<div id="apar_obj_centr_log" style="display: none">
									<p>Insert the parameters for the object-centric log extraction:</p>
								</div>
							</td>
						</tr>
					</table>
				</div>
				<div id="p2p" style="display: none">
					<p><b>Procure-to-Pay</b></p>
					<table border="0" style="width: 100%">
						<tr>
							<td style="width: 40%">
								<img src="static/p2p_red.png">
								</img>
							</td>
							<td style="width: 60%">
								Extraction Type:
								<select id="p2p_ext_type" name="p2p_ext_type" onchange="p2pExtChange()">
									<option value="p2p_1d_dataframe">CSV log</option>
									<option value="p2p_1d_log" selected="selected">XES log</option>
								</select>
								<br />
								<div id="p2p_1d_dataframe" style="display: none">
									<p>Insert the parameters for the CSV extraction:</p>
								</div>
								<div id="p2p_1d_log" style="display: ">
									<p>Insert the parameters for the XES extraction:</p>
								</div>
							</td>
						</tr>
					</table>
				</div>
			</div>
			<br />
			<button onclick="javascript:extract()">Extract the Event Log</button>
        </div>
    </body>
	<script type="text/javascript">
		function changeConnectionType() {
			let connection_type = document.getElementById("connection_types").value;
			if (connection_type == "sqlite") {
				document.getElementById("sqlite_conn_parameters").style.display = "";
				document.getElementById("oracle_conn_parameters").style.display = "none";
			}
			else if (connection_type == "oracle") {
				document.getElementById("sqlite_conn_parameters").style.display = "none";
				document.getElementById("oracle_conn_parameters").style.display = "";
			}
		}
		
		function changeProcess() {
			let proc = document.getElementById("available_processes").value;
			if (proc == "o2c") {
				document.getElementById("o2c").style.display = "";
				document.getElementById("p2p").style.display = "none";
				document.getElementById("ap_ar").style.display = "none";
			}
			else if (proc == "ap_ar") {
				document.getElementById("o2c").style.display = "none";
				document.getElementById("p2p").style.display = "none";
				document.getElementById("ap_ar").style.display = "";
			}
			else if (proc == "p2p") {
				document.getElementById("o2c").style.display = "none";
				document.getElementById("p2p").style.display = "";
				document.getElementById("ap_ar").style.display = "none";
			}
		}
		
		function o2cExtChange() {
			let ext = document.getElementById("o2c_ext_type").value;
			if (ext == "o2c_1d_log_extractor") {
				document.getElementById("o2c_log").style.display = "";
				document.getElementById("o2c_dataframe").style.display = "none";
				document.getElementById("o2c_obj").style.display = "none";
			}
			else if (ext == "o2c_1d_dataframe_extractor") {
				document.getElementById("o2c_log").style.display = "none";
				document.getElementById("o2c_dataframe").style.display = "";
				document.getElementById("o2c_obj").style.display = "none";
			}
			else if (ext == "o2c_obj_centric_log") {
				document.getElementById("o2c_log").style.display = "none";
				document.getElementById("o2c_dataframe").style.display = "none";
				document.getElementById("o2c_obj").style.display = "";
			}
		}
		
		function apArExtChange() {
			let ext = document.getElementById("apar_ext_type").value;
			
			document.getElementById("single_doc_transactions_dataframe").style.display = "none";
			document.getElementById("single_doc_transactions_log").style.display = "none";
			document.getElementById("document_flow_dataframe").style.display = "none";
			document.getElementById("document_flow_log").style.display = "none";
			document.getElementById("doc_flow_transactions_dataframe").style.display = "none";
			document.getElementById("doc_flow_transactions_xes").style.display = "none";
			document.getElementById("apar_obj_centr_log").style.display = "none";
			
			if (ext == "single_doc_transactions_dataframe") {
				document.getElementById("single_doc_transactions_dataframe").style.display = "";
			}
			else if (ext == "single_doc_transactions_log") {
				document.getElementById("single_doc_transactions_log").style.display = "";
			}
			else if (ext == "document_flow_dataframe") {
				document.getElementById("document_flow_dataframe").style.display = "";
			}
			else if (ext == "document_flow_log") {
				document.getElementById("document_flow_log").style.display = "";
			}
			else if (ext == "doc_flow_transactions_dataframe") {
				document.getElementById("doc_flow_transactions_dataframe").style.display = "";
			}
			else if (ext == "doc_flow_transactions_xes") {
				document.getElementById("doc_flow_transactions_xes").style.display = "";
			}
			else if (ext == "apar_obj_centr_log") {
				document.getElementById("apar_obj_centr_log").style.display = "";
			}
		}
		
		function p2pExtChange() {
			let ext = document.getElementById("p2p_ext_type").value;
			
			document.getElementById("p2p_1d_dataframe").style.display = "none";
			document.getElementById("p2p_1d_log").style.display = "none";
			
			if (ext == "p2p_1d_dataframe") {
				document.getElementById("p2p_1d_dataframe").style.display = "";
			}
			else if (ext == "p2p_1d_log") {
				document.getElementById("p2p_1d_log").style.display = "";
			}
		}
		
		function extract() {
			let db_type = document.getElementById("connection_types").value;
			let db_con_args = {};
			if (db_type == "sqlite") {
				db_con_args = getSqliteDbConArgs();
			}
			else if (db_type == "oracle") {
				db_con_args = getOracleDbConArgs();
			}
			let process = document.getElementById("available_processes").value;
			let ext_type = "";
			let ext_args = {};
			if (process == "o2c") {
				ext_type = document.getElementById("o2c_ext_type").value;
				ext_args = getO2Cparameters(ext_type);
			}
			else if (process == "ap_ar") {
				ext_type = document.getElementById("apar_ext_type").value;
				ext_args = getAPARparameters(ext_type);
			}
			else if (process == "p2p") {
				ext_type = document.getElementById("p2p_ext_type").value;
				ext_args = getP2Pparameters(ext_type);
			}
			var obj = {};
			obj["db_type"] = db_type;
			obj["db_con_args"] = db_con_args;
			obj["process"] = process;
			obj["ext_type"] = ext_type;
			obj["ext_args"] = ext_args;
			obj = JSON.stringify(obj);
			obj = btoa(obj);
			window.open("http://localhost:5000/downloadLog?parameters="+obj);
		}
		
		function getSqliteDbConArgs() {
			let db_con_args = {};
			db_con_args["path"] = document.getElementById("sqlite_db_path").value;
			return db_con_args;
		}
		
		function getOracleDbConArgs() {
			let db_con_args = {};
			db_con_args["hostname"] = document.getElementById("oracle_hostname").value;
			db_con_args["port"] = document.getElementById("oracle_port").value;
			db_con_args["sid"] = document.getElementById("oracle_sid").value;
			db_con_args["username"] = document.getElementById("oracle_username").value;
			db_con_args["password"] = document.getElementById("oracle_password").value;
			return db_con_args;
		}
		
		function getO2Cparameters(ext_type) {
			if (ext_type == "o2c_1d_log_extractor") {
				return getO2CparametersXES(ext_type);
			}
			else if (ext_type == "o2c_1d_dataframe_extractor") {
				return getO2CparametersCSV(ext_type);
			}
			else if (ext_type == "o2c_obj_centric_log") {
				return getO2CparametersOL(ext_type);
			}
		}
		
		function getO2CparametersXES(ext_type) {
			let ext_args = {};
			return ext_args;
		}
		
		function getO2CparametersCSV(ext_type) {
			let ext_args = {};
			return ext_args;
		}
		
		function getO2CparametersOL(ext_type) {
			let ext_args = {};
			return ext_args;
		}
		
		function getAPARparameters(ext_type) {
			if (ext_type == "single_doc_transactions_dataframe") {
				return getAPARparametersSTCSV(ext_type);
			}
			else if (ext_type == "single_doc_transactions_log") {
				return getAPARparametersSTXES(ext_type);
			}
			else if (ext_type == "document_flow_dataframe") {
				return getAPARparametersDFCSV(ext_type);
			}
			else if (ext_type == "document_flow_log") {
				return getAPARparametersDFXES(ext_type);
			}
			else if (ext_type == "doc_flow_transactions_dataframe") {
				return getAPARparametersDFTCSV(ext_type);
			}
			else if (ext_type == "doc_flow_transactions_xes") {
				return getAPARparametersDFTXES(ext_type);
			}
			else if (ext_type == "apar_obj_centr_log") {
				return getAPARparametersOL(ext_type);
			}
		}
		
		function getAPARparametersSTCSV(ext_type) {
			let ext_args = {};
			return ext_args;
		}
		
		function getAPARparametersSTXES(ext_type) {
			let ext_args = {};
			return ext_args;
		}
		
		function getAPARparametersDFCSV(ext_type) {
			let ext_args = {};
			return ext_args;
		}
		
		function getAPARparametersDFXES(ext_type) {
			let ext_args = {};
			return ext_args;
		}
		
		function getAPARparametersDFTCSV(ext_type) {
			let ext_args = {};
			return ext_args;
		}
		
		function getAPARparametersDFTXES(ext_type) {
			let ext_args = {};
			return ext_args;
		}
		
		function getAPARparametersOL(ext_type) {
			let ext_args = {};
			return ext_args;
		}
		
		function getP2Pparameters(ext_type) {
			if (ext_type == "p2p_1d_dataframe") {
				return getP2PparametersCSV(ext_type);
			}
			else if (ext_type == "p2p_1d_log") {
				return getP2PparametersXES(ext_type);
			}
		}
		
		function getP2PparametersCSV(ext_type) {
			let ext_args = {};
			return ext_args;
		}
		
		function getP2PparametersXES(ext_type) {
			let ext_args = {};
			return ext_args;
		}
	</script>
</html>